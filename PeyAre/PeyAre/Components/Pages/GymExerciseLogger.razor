@page "/log-exercise"
@using PeyAre.Data
@using PeyAre.Models
@using Microsoft.EntityFrameworkCore
@inject ApplicationDbContext _context



<div style="display: flex; justify-content: center; align-items: center; height: 80vh; padding: 20px;">
    <!-- Exercise Logging Card -->
    <MudCard Class="mud-elevation-4" Style="background-color:#F5F5F5; padding:20px; border-radius: 10px; width: 700px;">
        <MudCardContent>
            <MudText Typo="Typo.h5" Style="text-align:center; margin-bottom: 20px;">Log Your Exercise</MudText>

            <!-- Exercise Name -->
            <MudTextField @bind-Value="exerciseLog.ExerciseName" Label="Exercise Name" Style="margin-bottom: 10px; width: 100%;" />

            <!-- Sets -->
            <MudTextField @bind-Value="exerciseLog.Sets" Label="Sets" Type="number" Style="margin-bottom: 10px; width: 100%;" />

            <!-- Reps -->
            <MudTextField @bind-Value="exerciseLog.Reps" Label="Reps" Type="number" Style="margin-bottom: 10px; width: 100%;" />

            <!-- Weight -->
            <MudTextField @bind-Value="exerciseLog.Weight" Label="Weight Lifted (kg)" Type="number" Style="margin-bottom: 10px; width: 100%;" />

            <!-- Notes -->
            <MudTextField @bind-Value="exerciseLog.Notes" Label="Notes" Style="margin-bottom: 10px; width: 100%;" />

            <!-- Save Button -->
            <MudButton OnClick="SaveExerciseLog" Color="Color.Primary" Variant="Variant.Filled" Style="width: 100%; margin-top: 20px;">
                Save Exercise Log
            </MudButton>

            <!-- Status Message -->
            <MudText Typo="Typo.body2" Style="color:#6D6D6D;">
                @statusMessage
            </MudText>
        </MudCardContent>
    </MudCard>
</div>

@code {
    private GymExerciseLogModel exerciseLog = new GymExerciseLogModel();
    private string statusMessage = string.Empty;

    // Method to handle saving the exercise log
    private async Task SaveExerciseLog()
    {
        if (string.IsNullOrEmpty(exerciseLog.ExerciseName) || exerciseLog.Sets <= 0 || exerciseLog.Reps <= 0 || exerciseLog.Weight <= 0)
        {
            statusMessage = "Please fill out all fields with valid values.";
        }
        else
        {
            exerciseLog.Date = DateTime.UtcNow;
            _context.GymExerciseLogs.Add(exerciseLog);
            await _context.SaveChangesAsync();

            statusMessage = "Exercise log saved successfully!";
            exerciseLog = new GymExerciseLogModel(); // Reset the form after saving
        }
    }
}